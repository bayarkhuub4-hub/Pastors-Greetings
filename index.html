<script>
        // --- 1. URL ПАРАМЕТР УНШИХ ---
        const params = new URLSearchParams(window.location.search);
        const name = params.get('n') || "Ах, эгч дүү минь";
        const amount = params.get('a'); 
        document.getElementById('userName').innerText = name.toUpperCase();

        if (!amount || amount === "0") {
            document.getElementById('offeringSection').style.display = 'none';
            document.getElementById('mainSubtitle').innerText = "2026 ОНЫ ЕРӨӨЛИЙН МЭНДЧИЛГЭЭ";
            document.getElementById('topLabel').innerText = "Шинэ оны мэнд";
            document.getElementById('blessingText').innerText = "Ирэх онд Бурханы амар амгалан, ерөөл таны гэр бүл, амьдралд дүүрэн бялхах болтугай. Бидэнтэй хамт байсанд баярлалаа!";
            document.getElementById('verseText').innerHTML = '"Эзэн чамайг ерөөж, чамайг сахиж хамгаалах болтугай." <br> (Тооллого 6:24)';
        } else {
            document.getElementById('userAmount').innerText = amount + " ₮";
        }

        // --- 2. ВИДЕО ХЯНАЛТ (5 СЕКУНДЫН ӨМНӨ ГАРГАХ) ---
        const vid = document.getElementById('mainVideo');
        const afterVid = document.getElementById('afterVideoContainer');

        function startApp() {
            document.getElementById('initialOverlay').style.display = 'none';
            vid.style.display = 'block';
            vid.play();
        }

        // Цаг хянах функц
        vid.ontimeupdate = function() {
            // Видеоны үлдэгдэл хугацаа 5 секундээс бага болмогц товчийг гаргана
            if (vid.duration > 0 && (vid.duration - vid.currentTime <= 5)) {
                afterVid.style.display = 'flex';
            }
        };

        // Видео бүрэн дуусахад арын дүрсийг бүдгэрүүлж харанхуйлах
        vid.onended = () => {
            afterVid.style.background = 'rgba(0, 0, 0, 0.95)';
            afterVid.style.backdropFilter = 'blur(10px)';
        };

        // Бусад эффектүүд (Canvas)
        const canvas = document.getElementById('canvas-lights');
        const ctx = canvas.getContext('2d');
        let lights = [];
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();
        class Light { constructor() { this.reset(); this.y = Math.random() * canvas.height; } reset() { this.x = Math.random() * canvas.width; this.y = canvas.height + 10; this.size = Math.random() * 2 + 1; this.speed = Math.random() * 0.5 + 0.2; this.opacity = Math.random() * 0.5; } update() { this.y -= this.speed; if (this.y < -10) this.reset(); } draw() { ctx.fillStyle = `rgba(252, 246, 186, ${this.opacity})`; ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill(); } }
        for (let i = 0; i < 50; i++) lights.push(new Light());
        function animate() { ctx.clearRect(0, 0, canvas.width, canvas.height); lights.forEach(l => { l.update(); l.draw(); }); requestAnimationFrame(animate); }
        animate();
    </script>